(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[870],{2554:(e,t,a)=>{Promise.resolve().then(a.bind(a,7943))},2770:(e,t,a)=>{"use strict";a.d(t,{A:()=>n});var r=a(5155);a(2115);var s=a(5695);let n=()=>{let e=(0,s.useRouter)(),t="/"===(0,s.usePathname)();return(0,r.jsx)("header",{className:"fixed top-0 left-0 right-0 z-50 w-full max-w-xl mx-auto h-[70px] bg-[#F9F9F9] border-b border-[#777] flex items-center justify-center select-none",children:(0,r.jsxs)("div",{className:"w-full max-w-xl flex items-center justify-between px-5 relative",children:[(0,r.jsxs)("button",{onClick:()=>e.back(),className:"bg-none border-none text-[20px] cursor-pointer text-black  p-0 flex items-center transition-opacity duration-200 ".concat(t?"opacity-0 pointer-events-none":"opacity-100"),"aria-hidden":t,tabIndex:t?-1:0,children:["<"," ",(0,r.jsx)("span",{className:"ml-1 hidden sm:inline",children:"Back"})]}),(0,r.jsx)("h1",{className:"absolute left-1/2 transform -translate-x-1/2 text-[20px] font-bold text-black text-center cursor-pointer select-none m-0",onClick:()=>e.push("/"),children:"USTB"}),(0,r.jsx)("div",{className:"w-[60px]"})]})})}},7145:(e,t,a)=>{"use strict";a.d(t,{A:()=>i});var r=a(5155);a(2115);var s=a(5695),n=a(8396);let l=[{id:1,label:"HOME",path:"/"},{id:2,label:"Community",path:"/community"},{id:3,label:"Chat",path:"/chatlist",requireAuth:!0},{id:5,label:"MY",path:"/mypage",requireAuth:!0}],i=()=>{let e=(0,s.useRouter)(),t=(0,s.usePathname)(),a=t=>{t.requireAuth&&!n.j.currentUser?e.push("/login"):e.push(t.path)};return(0,r.jsx)("nav",{className:"fixed bottom-0 left-0 right-0 z-50 w-full max-w-xl mx-auto h-[60px] bg-[#f8f8f8] border-t-2 border-[#cecece] flex justify-around items-center select-none",children:l.map(e=>{let s=t===e.path||"/"!==e.path&&t.startsWith(e.path);return(0,r.jsxs)("button",{onClick:()=>a(e),"aria-label":e.label,className:"flex flex-col items-center justify-center flex-1 max-w-[150px] bg-none border-none outline-none",type:"button",children:[(0,r.jsx)("div",{className:"w-6 h-6 rounded-full border-2 flex items-center justify-center mb-1 ".concat(s?"border-orange-500 bg-orange-500":"border-gray-400 bg-transparent")}),(0,r.jsx)("span",{className:"text-[10px] text-[#777] select-none",children:e.label})]},e.id)})})}},7943:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>u});var r=a(5155),s=a(2115),n=a(5695),l=a(5317),i=a(8396);async function c(e,t){var a;if(!i.j.currentUser)return void(0,n.redirect)("/login");let r=i.j.currentUser.uid,s=null!=(a=i.j.currentUser.email)?a:"noemail@example.com",c=[r,e].sort(),o=(0,l.P)((0,l.rJ)(i.db,"chats"),(0,l._M)("user_uids","==",c)),d=await (0,l.GG)(o);if(d.empty){let a=await (0,l.gS)((0,l.rJ)(i.db,"chats"),{user1_uid:r,user1_email:s,user2_uid:e,user2_email:t,user_uids:c,user1_exited:!1,user2_exited:!1,created_at:(0,l.O5)(),last_message:"",last_message_at:(0,l.O5)()});(0,n.redirect)("/chat/".concat(a.id))}else{let e=d.docs[0].id;(0,n.redirect)("/chat/".concat(e))}}var o=a(2770),d=a(7145);function u(){var e;let t=(0,n.useParams)(),[a,u]=(0,s.useState)(null),[m,x]=(0,s.useState)(!0),h=Array.isArray(null==t?void 0:t.id)?t.id[0]:null==t?void 0:t.id;(0,s.useEffect)(()=>{(async()=>{if(h)try{let e=(0,l.H9)(i.db,"posts",h),t=await (0,l.x7)(e);t.exists()?u({id:t.id,...t.data()}):console.error("No such document!")}catch(e){console.error("Error fetching post:",e)}finally{x(!1)}})()},[h]);let p=async()=>{if(h)try{let e=(0,l.H9)(i.db,"posts",h);await (0,l.mZ)(e,{likes_count:(0,l.GV)(1)}),u(e=>e?{...e,likes_count:e.likes_count+1}:e)}catch(e){console.error("Error updating likes:",e)}};return m?(0,r.jsx)("div",{className:"text-center mt-10",children:"Loading..."}):a?(0,r.jsxs)("div",{className:"pt-[70px] pb-[60px] max-w-xl mx-auto min-h-screen bg-white",children:[(0,r.jsx)(o.A,{}),(0,r.jsxs)("main",{className:"p-5",children:[(0,r.jsxs)("div",{className:"mb-6",children:[(0,r.jsx)("h1",{className:"text-2xl font-bold text-yellow-500",children:a.title}),(0,r.jsxs)("div",{className:"text-sm text-gray-500 mt-2",children:[a.author_nickname," (",a.author_email,")"]}),(0,r.jsx)("div",{className:"text-xs text-gray-400 mt-1",children:(null==(e=a.created_at)?void 0:e.toDate)?a.created_at.toDate().toLocaleString():""})]}),(0,r.jsx)("div",{className:"border p-4 rounded-md text-gray-700 leading-relaxed",children:a.content}),(0,r.jsxs)("div",{className:"flex items-center gap-4 mt-6",children:[(0,r.jsxs)("button",{onClick:p,className:"bg-yellow-400 hover:bg-yellow-500 text-white py-2 px-4 rounded font-bold",children:["❤️ Like ",a.likes_count]}),(0,r.jsx)("button",{onClick:()=>c(a.author_uid,a.author_email),className:"bg-orange-400 hover:bg-orange-500 text-white py-2 px-4 rounded font-bold",children:"✉️ Send Message"})]})]}),(0,r.jsx)(d.A,{})]}):(0,r.jsx)("div",{className:"text-center mt-10",children:"Cannot Find Post"})}},8396:(e,t,a)=>{"use strict";a.d(t,{db:()=>i,h:()=>o,j:()=>c});var r=a(3915),s=a(5317),n=a(6203);let l=(0,r.Wp)({apiKey:"AIzaSyDSTAcpdQ-fDPw10h9wz3y_cS-bywHgVAY",authDomain:"community-chat-app-68996.firebaseapp.com",projectId:"community-chat-app-68996",storageBucket:"community-chat-app-68996.appspot.com",messagingSenderId:"523216978134",appId:"1:523216978134:web:a4bae7b951e880a7f78977",measurementId:"G-3VB219MYP1"}),i=(0,s.aU)(l),c=(0,n.xI)(l),o=new n.HF}},e=>{var t=t=>e(e.s=t);e.O(0,[992,158,678,441,684,358],()=>t(2554)),_N_E=e.O()}]);